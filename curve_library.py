import maya.cmds as cmds

class RigCurveLibrary(object):
	
	@classmethod
	def circle(cls, radius=1.0, name="circle_crv"):
		return cmds.circle(center=(0, 0, 0), normal=(0, 1, 0), radius=radius, name=name)[0]
	
	@classmethod
	def two_way_arrow(cls, name="two_way_arrow_crv"):
		return cmds.curve(
			degree=1,
			point=[
				(-1, 0, -2),
				(-2, 0, -2),
				(0, 0, -4),
				(2, 0, -2),
				(1, 0, -2),
				(1, 0, 2),
				(2, 0, 2),
				(0, 0, 4),
				(-2, 0, 2),
				(-1, 0, 2),
				(-1, 0, -2)
			],
			knot=list(range(11)),
			name=name
		)
	@classmethod
	def create_cube_curve(cls, name="cube"):
		cube = cmds.curve(degree=1, point=[
			[-0.5, 0.5, 0.5],
			[0.5, 0.5, 0.5],
			[0.5, -0.5, 0.5],
			[-0.5, -0.5, 0.5],
			[-0.5, 0.5, 0.5],
			[-0.5, 0.5, -0.5],
			[0.5, 0.5, -0.5],
			[0.5, 0.5, 0.5],
			[0.5, -0.5, 0.5],
			[0.5, -0.5, -0.5],
			[0.5, 0.5, -0.5],
			[-0.5, 0.5, -0.5],
			[-0.5, -0.5, -0.5],
			[0.5, -0.5, -0.5],
			[0.5, -0.5, 0.5],
			[-0.5, -0.5, 0.5],
			[-0.5, -0.5, -0.5]
		],
						  name=name)
		return cube
	@classmethod
	def create_rectangle_line_curve(cls, name="rectangle_line"):
		points = [
			[-1.0, 0.0, -1.0],  # CV[0]
			[-1.0, 0.0, 0.0],  # CV[1]
			[0.0, 0.0, 0.0],  # CV[2]
			[1.0, 0.0, 0.0],  # CV[3]
			[1.0, 0.0, -1.0],  # CV[4]
			[-1.0, 0.0, -1.0],  # CV[5] - close loop
			[-1.0, 0.0, 0.0],  # CV[6]
			[0.0, 0.0, 0.0],  # CV[7]
			[0.0, 0.0, -1.0],  # CV[8]
			[0.0, 0.0, 0.0],  # CV[9]
			[0.0, 0.0, 1.0]  # CV[10]
		]
		
		rec_line = cmds.curve(degree=1, point=points, name=name)
		return rec_line
	@classmethod
	def create_rectangle_curve(cls, name="rectangle"):
		points = [
			[-1.0, 0.0, -1.0],  # CV[0]
			[-1.0, 0.0, 0.0],  # CV[1]
			[1.0, 0.0, 0.0],  # CV[2]
			[1.0, 0.0, -1.0],  # CV[3]
			[-1.0, 0.0, -1.0]  # CV[4] - closing the loop
		]
		
		rec = cmds.curve(degree=1, point=points, name=name)
		return rec
	@classmethod
	def create_square_curve(cls, name="square", size=50):
		points = [
			[-1.0, 0.0, -1.0],  # CV[0]
			[-1.0, 0.0, 1.0],  # CV[1]
			[1.0, 0.0, 1.0],  # CV[2]
			[1.0, 0.0, -1.0],  # CV[3]
			[-1.0, 0.0, -1.0]  # CV[4] - closing the loop
		]
		
		square = cmds.curve(name=name, degree=1, point=points)
		return square
	@classmethod
	def create_rectangle_line_2(cls, name="rectangle line 2"):
		points = [
			[-2.0, 1.0, 0.0],  # CV[0]
			[-2.0, -1.0, 0.0],  # CV[1]
			[2.0, -1.0, 0.0],  # CV[2]
			[2.0, 1.0, 0.0],  # CV[3]
			[-2.0, 1.0, 0.0],  # CV[4]
			[0.0, 0.0, 0.0],  # CV[5]
			[0.0, 0.0, 2.0],  # CV[6]
			[0.0, 0.0, 0.0],  # CV[7]
			[2.0, 1.0, 0.0],  # CV[8]
			[2.0, -1.0, 0.0],  # CV[9]
			[0.0, 0.0, 0.0],  # CV[10]
			[2.0, -1.0, 0.0],  # CV[11]
			[-2.0, -1.0, 0.0],  # CV[12]
			[0.0, 0.0, 0.0]  # CV[13]
		]
		
		curve = cmds.curve(name=name, degree=1, point=points)
		return curve
	
	@classmethod
	def create_diamond(cls, name="diamond"):
		points = [
			[7.360295492086398e-07, 12.854696039846903, 2.6969651662128694e-06],
			[4.532699824175749, 10.977191977264255, 1.978351797561391e-06],
			[6.410202845855181, 6.4444924579622445, 1.6806927194639979e-06],
			[4.532698783272554, 1.9117933698159675, 1.978351797561391e-06],
			[-7.360293973393767e-07, 0.03429034813648535, 2.6969651662128694e-06],
			[-4.5326998241756975, 1.9117944107191747, 2.740154668859026e-06],
			[-6.410202845855189, 6.4444939300211495, 2.758040441847511e-06],
			[-4.53269878327252, 10.977193018167426, 2.740154668859026e-06],
			[7.360295492086398e-07, 12.854696039846903, 2.6969651662128694e-06],
			[2.26635275507834, 10.977192237489763, -3.925426399464013],
			[3.205100542810302, 6.4444928259770435, -5.551393730752744],
			[2.2663517141751557, 1.911793630041462, -3.925426399464013],
			[-7.360293973393767e-07, 0.03429034813648535, 2.6969651662128694e-06],
			[2.26634654864588, 1.911793630042082, 3.92543107478102],
			[3.2051023030449786, 6.4444928259768695, 5.551398108410686],
			[2.266347589549069, 10.977192237490303, 3.92543107478102],
			[7.360295492086398e-07, 12.854696039846903, 2.6969651662128694e-06],
			[-2.2663465486467453, 10.977192757941367, -3.925432091053521],
			[-3.2051023030458317, 6.444493562006521, -5.551399124683152],
			[-2.2663475895499317, 1.9117941504930531, -3.925432091053521],
			[-7.360293973393767e-07, 0.03429034813648535, 2.6969651662128694e-06],
			[-2.2663463448753403, 1.911794150492904, 3.925431793393355],
			[-3.205100542810149, 6.444493562006308, 5.551399124683115],
			[-2.266345303972156, 10.977192757941204, 3.925431793393355],
			[7.360295492086398e-07, 12.854696039846903, 2.6969651662128694e-06],
			[2.266347589549069, 10.977192237490303, 3.92543107478102],
			[-2.266345303972156, 10.977192757941204, 3.925431793393355],
			[-4.53269878327252, 10.977193018167426, 2.740154668859026e-06],
			[-2.2663465486467453, 10.977192757941367, -3.925432091053521],
			[2.26635275507834, 10.977192237489763, -3.925426399464013],
			[4.532699824175749, 10.977191977264255, 1.978351797561391e-06],
			[2.266347589549069, 10.977192237490303, 3.92543107478102],
			[3.2051023030449786, 6.4444928259768695, 5.551398108410686],
			[6.410202845855181, 6.4444924579622445, 1.6806927194639979e-06],
			[3.205100542810302, 6.4444928259770435, -5.551393730752744],
			[-3.2051023030458317, 6.444493562006521, -5.551399124683152],
			[-6.410202845855189, 6.4444939300211495, 2.758040441847511e-06],
			[-3.205100542810149, 6.444493562006308, 5.551399124683115],
			[3.2051023030449786, 6.4444928259768695, 5.551398108410686],
			[2.26634654864588, 1.911793630042082, 3.92543107478102],
			[-2.2663463448753403, 1.911794150492904, 3.925431793393355],
			[-4.5326998241756975, 1.9117944107191747, 2.740154668859026e-06],
			[-2.2663475895499317, 1.9117941504930531, -3.925432091053521],
			[2.2663517141751557, 1.911793630041462, -3.925426399464013],
			[4.532698783272554, 1.9117933698159675, 1.978351797561391e-06],
			[2.26634654864588, 1.911793630042082, 3.92543107478102],
		]
		
		diamond = cmds.curve(name=name, degree=1, point=points)
		return diamond
	
	@classmethod
	def create_lollipop_ctrl(cls, name="lollipop_ctrl", scale=1.0):
		"""
		Create a stylized lollipop control as one transform with two curve shapes:
		- a stick (linear)
		- a circular head (periodic cubic)
		"""
		
		# --- Lollipop stick (curve 1) ---
		lollipop_1 = [
			1,  # degree
			[(0.0, 0.0, -0.595),
			 (0.0, 0.0, 0.202),
			 (0.0, 0.0, 1.0)],  # CVs
			[0.0, 1.0, 2.0]  # knots
		]
		
		stick = cmds.curve(
			d=lollipop_1[0],
			p=[(x * scale, y * scale, z * scale) for x, y, z in lollipop_1[1]],
			k=lollipop_1[2],
			n=f"{name}_stickTmp"
		)
		
		# --- Lollipop head (curve 2) ---
		lollipop_2 = [
			True,  # periodic
			3,  # degree
			[(0.156, 0.0, -0.951),
			 (0.0, 0.0, -1.015),
			 (-0.156, 0.0, -0.951),
			 (-0.221, 0.0, -0.794),
			 (-0.156, 0.0, -0.638),
			 (0.0, 0.0, -0.573),
			 (0.156, 0.0, -0.638),
			 (0.221, 0.0, -0.794),
			 (0.156, 0.0, -0.951),
			 (0.0, 0.0, -1.015),
			 (-0.156, 0.0, -0.951)],  # CVs
			[-2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]  # knots
		]
		
		head = cmds.curve(
			per=lollipop_2[0],
			d=lollipop_2[1],
			p=[(x * scale, y * scale, z * scale) for x, y, z in lollipop_2[2]],
			k=lollipop_2[3],
			n=f"{name}_headTmp"
		)
		
		# --- Combine both curves into one transform ---
		ctrl = cmds.createNode("transform", n=name)
		for src in (stick, head):
			shapes = cmds.listRelatives(src, s=True, path=True) or []
			for s in shapes:
				cmds.parent(s, ctrl, add=True, shape=True)
			cmds.delete(src)
		
		# --- Optional: tidy up shape names ---
		shapes = cmds.listRelatives(ctrl, s=True, fullPath=False) or []
		for i, s in enumerate(shapes, 1):
			cmds.rename(s, f"{name}Shape_{i:02d}")
		
		return ctrl


	@classmethod
	def create_arrow_curve(cls, name="arrow_crv", scale=1.0):
		"""
		Create an arrow-shaped curve using predefined CV data.
		"""
		points = [
			(0.166, 0.0, 0.166),
			(0.664, 0.0, 0.166),
			(0.664, 0.0, 0.332),
			(0.996, 0.0, 0.0),
			(0.664, 0.0, -0.332),
			(0.664, 0.0, -0.166),
			(0.166, 0.0, -0.166),
			(0.166, 0.0, -0.664),
			(0.332, 0.0, -0.664),
			(0.0, 0.0, -0.996),
			(-0.332, 0.0, -0.664),
			(-0.166, 0.0, -0.664),
			(-0.166, 0.0, -0.166),
			(-0.664, 0.0, -0.166),
			(-0.664, 0.0, -0.332),
			(-0.996, 0.0, 0.0),
			(-0.664, 0.0, 0.332),
			(-0.664, 0.0, 0.166),
			(-0.166, 0.0, 0.166),
			(-0.166, 0.0, 0.664),
			(-0.332, 0.0, 0.664),
			(0.0, 0.0, 0.996),
			(0.332, 0.0, 0.664),
			(0.166, 0.0, 0.664),
			(0.166, 0.0, 0.166)
		]
		
		points = [(p[0] * scale, p[1] * scale, p[2] * scale) for p in points]
		
		crv = cmds.curve(name=name, degree=1, point=points)
		return crv

	@classmethod
	def create_arrow_curve(cls, name="arrow_ctrl"):
		"""
		Create a simple arrow-shaped curve controller.
		Uses predefined CV and knot data.
		"""
		points = [
			(-0.243, 0.0, -1.0),
			(0.243, 0.0, -1.0),
			(0.243, 0.0, 0.271),
			(0.485, 0.0, 0.271),
			(0.0, 0.0, 1.0),
			(-0.485, 0.0, 0.271),
			(-0.243, 0.0, 0.271),
			(-0.243, 0.0, -1.0)
		]
	
		knots = [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0]
	
		curve = cmds.curve(
			name=name,
			degree=1,
			point=points,
			knot=knots
		)
	
		return curve
	
	@classmethod
	def create_prism_line(cls, name="prism_line_crv", scale=1.0):
		"""
		Create a stylized prism-like line curve using fixed CV data.
		The design forms a faceted geometric prism line, good for
		indicator or tangent-style controls.

		Args:
			name (str): Name for the resulting curve transform.
			scale (float): Global scale factor for the shape.

		Returns:
			str: The name of the created curve transform.
		"""
		# Base CV coordinates
		prism_points = [
			(15.824022630594634, -0.2481229434638692, -5.309948661739526),
			(15.824022630594637, -0.24812294346386787, 5.053492313992219),
			(14.482894681937026, 4.7570347003769715, -0.1282281738736497),
			(15.824022630594634, -0.2481229434638692, -5.309948661739526),
			(17.16515057925225, -5.253280587304701, -0.1282281738736497),
			(15.824022630594637, -0.24812294346386787, 5.053492313992219),
			(10.818864986753798, -1.5892508921214819, -0.12822817387364793),
			(15.824022630594634, -0.2481229434638692, -5.309948661739526),
			(20.829180274435473, 1.0930050051937448, -0.12822817387365504),
			(15.824022630594637, -0.24812294346386787, 5.053492313992219),
			(14.482894681937026, 4.7570347003769715, -0.1282281738736497),
			(10.818864986753798, -1.5892508921214819, -0.12822817387364793),
			(17.16515057925225, -5.253280587304701, -0.1282281738736497),
			(20.829180274435473, 1.0930050051937448, -0.12822817387365504),
			(14.482894681937026, 4.7570347003769715, -0.1282281738736497),
			(15.824022630594637, -0.24812294346386832, -0.1282281738736497),
			(17.16515057925225, -5.253280587304701, -0.1282281738736497),
			(15.824022630594637, -0.24812294346386832, -0.1282281738736497),
			(0.3395592963495222, -4.397172389104176, -0.12822817387365326)
		]
		
		# Apply scale
		prism_points = [(x * scale, y * scale, z * scale) for (x, y, z) in prism_points]
		
		# Create curve
		prism_curve = cmds.curve(
			degree=1,  # Straight-line segments (faceted)
			p=prism_points,
			name=name
		)
		
		return prism_curve
	
	import maya.cmds as cmds
	
	@classmethod
	def create_diamond_sphere(cls, name="diamond_sphere_crv"):
		"""Create a stylized diamond-sphere curve using stored CV positions."""
		cvs = [
			[-0.0659922907553101, 0.7032221129186319, 0.001103400818318296],
			[-0.059964922671826244, 0.5921042524786723, 0.2692981222833049],
			[-0.05746830827729792, 0.3238417849614283, 0.38038787039074273],
			[-0.05996492405596008, 0.055579342961629176, 0.269298060694229],
			[-0.0659922927127701, -0.05553845587370498, 0.0011033137182413467],
			[-0.07201962083218144, 0.05557940456625579, -0.26709140864489067],
			[-0.07451621867283681, 0.3238418720834961, -0.3781811571243625],
			[-0.07201961944804756, 0.5921043140832948, -0.26709134705581644],
			[-0.0659922907553101, 0.7032221129186319, 0.001103400818318296],
			[0.16928461327492197, 0.5921042678798076, 0.12998109601794453],
			[0.26673957047121427, 0.32384180674194946, 0.18336363105638814],
			[0.16928461189078836, 0.05557935836276711, 0.1299810344288709],
			[-0.0659922927127701, -0.05553845587370498, 0.0011033137182413467],
			[-0.29524182837285795, 0.055579358362804594, 0.14042035273910086],
			[-0.3902001704825563, 0.32384180674193913, 0.19812759660263765],
			[-0.29524182698872314, 0.5921042678798423, 0.1404204143281759],
			[-0.0659922907553101, 0.7032221129186319, 0.001103400818318296],
			[0.1632576241892897, 0.5921042986821231, -0.13821364672652553],
			[0.25821596629898574, 0.32384185030298457, -0.19592089059006115],
			[0.1632576228051562, 0.055579389165079755, -0.13821370831560004],
			[-0.0659922927127701, -0.05553845587370498, 0.0011033137182413467],
			[-0.3012691882190205, 0.055579389165071685, -0.12777400219687207],
			[-0.39872415393929683, 0.3238418503029723, -0.18115691651982804],
			[-0.30126918683488707, 0.5921042986821127, -0.12777394060779743],
			[-0.0659922907553101, 0.7032221129186319, 0.001103400818318296],
			[-0.29524182698872314, 0.5921042678798423, 0.1404204143281759],
			[-0.30126918683488707, 0.5921042986821127, -0.12777394060779743],
			[-0.07201961944804756, 0.5921043140832948, -0.26709134705581644],
			[0.1632576241892897, 0.5921042986821231, -0.13821364672652553],
			[0.16928461327492197, 0.5921042678798076, 0.12998109601794453],
			[-0.059964922671826244, 0.5921042524786723, 0.2692981222833049],
			[-0.29524182698872314, 0.5921042678798423, 0.1404204143281759],
			[-0.3902001704825563, 0.32384180674193913, 0.19812759660263765],
			[-0.05746830827729792, 0.3238417849614283, 0.38038787039074273],
			[0.26673957047121427, 0.32384180674194946, 0.18336363105638814],
			[0.25821596629898574, 0.32384185030298457, -0.19592089059006115],
			[-0.07451621867283681, 0.3238418720834961, -0.3781811571243625],
			[-0.39872415393929683, 0.3238418503029723, -0.18115691651982804],
			[-0.3902001704825563, 0.32384180674193913, 0.19812759660263765],
			[-0.29524182837285795, 0.055579358362804594, 0.14042035273910086],
			[-0.3012691882190205, 0.055579389165071685, -0.12777400219687207],
			[-0.07201962083218144, 0.05557940456625579, -0.26709140864489067],
			[0.1632576228051562, 0.055579389165079755, -0.13821370831560004],
			[0.16928461189078836, 0.05557935836276711, 0.1299810344288709],
			[-0.05996492405596008, 0.055579342961629176, 0.269298060694229],
			[-0.29524182837285795, 0.055579358362804594, 0.14042035273910086],
		]
		
		curve = cmds.curve(degree=1, point=cvs, name=name)
		cmds.closeCurve(curve, preserveShape=True, replaceOriginal=True)
		return curve

	@classmethod
	def create_closed_arc(cls, name="crv_closedArc_0001"):
		"""
		Create a closed smooth arc curve (matches exported CV data).
		"""
		points = [
			[1.1661818804187263e-05, 7.140804715697577e-17, -1.1661819098648338],
			[1.0098622622512424e-21, 1.009862287519727e-16, -1.6492302731250061],
			[-1.1661819098648338, 7.140804715697576e-17, -1.1661819098648336],
			[-1.6492302731250073, 5.2351439313339124e-33, -8.54963885910424e-17],
			[-1.1661819098648338, -7.140804715697577e-17, 1.1661819098648338],
			[-1.6520452021744633e-21, -1.0098622875197275e-16, 1.6492302731250075],
			[1.1661818804187263e-05, -7.140804715697576e-17, 1.1661819098648336],
			[1.649230230915677e-05, -1.3771456358908273e-32, 2.2490495003941555e-16]
		]
		
		# degree = 3 for smooth circular curve
		degree = 3
		
		# uniform knots
		knots = list(range(len(points) + degree - 1))
		
		# create curve
		crv = cmds.curve(d=degree, p=points, k=knots, n=name)
		
		# close the curve (periodic)
		cmds.closeCurve(crv, ch=False, ps=True, rpo=True)
		
		return crv
	
	@classmethod
	def create_cross(cls, name="crv_cross_0001"):
		"""
		Create a cross-shaped curve (X, Y, Z intersecting lines).
		"""
		points = [
			[-4.209149223011579, 0.0, 1.7763568394002505e-15],
			[0.0, 0.0, 1.7763568394002505e-15],
			[4.209149223011579, 0.0, 1.7763568394002505e-15],
			[0.0, 0.0, 1.7763568394002505e-15],
			[0.0, 0.0, -4.209149223011579],
			[0.0, 0.0, 1.7763568394002505e-15],
			[0.0, 0.0, 4.209149223011579],
			[0.0, 0.0, 1.7763568394002505e-15],
			[0.0, 4.209149223011579, 1.7763568394002505e-15],
			[0.0, 0.0, 1.7763568394002505e-15],
			[0.0, -4.209149223011579, 1.7763568394002505e-15],
		]
		
		degree = 1
		knots = list(range(len(points)))
		
		crv = cmds.curve(d=degree, p=points, k=knots, n=name)
		
		return crv
	
	@classmethod
	def create_lollipop_round(cls, name="crv_lollipop_round"):
		"""
		Create a 'lollipop'-style rounded control curve using the provided CV data.
		The shape will be cubic (d=3), smooth, and properly closed at the *bottom*.
		"""
		import maya.cmds as cmds
		
		# CV data reordered so the last (closing) CV is the *bottom/stick* position
		points = [
			[0.0, 0.0, 4.200835800833189],  # top of the head
			[0.14250059713649532, 0.0, 0.0904995298629434],
			[1.107288881249637, 0.0, -0.8303719518471747],
			[1.0084497546476305, 0.0, -2.077950261453218],
			[0.0, 0.0, -2.4956638268000866],  # bottom center (stick start)
			[-1.0084497546476305, 0.0, -2.077950261453218],
			[-1.107288881249637, 0.0, -0.8303719518471749],
			[-0.14250059713649532, 0.0, 0.09049952986294707],
			[0.0, 0.0, 4.200835800833189],  # close back to top
			[0.0, 0.0, -2.4956638268000866]  # explicit bottom closing point
		]
		
		# Create cubic NURBS curve
		crv = cmds.curve(d=3, p=points, n=name)
		
		# Ensure curve closes cleanly at the *bottom* rather than top
		cmds.closeCurve(crv, ch=False, ps=False, rpo=True, bb=0.5, bki=False)
		
		# Freeze transforms
		cmds.makeIdentity(crv, apply=True, t=1, r=1, s=1, n=0)
		
		return crv
	
	@classmethod
	def create_ten_cross(cls, name="crv_cross"):
		"""
		Create a 'cross' style control curve.
		Shape: square border with a centered cross inside.
		"""
		import maya.cmds as cmds
		
		# Rounded + clean CVs from your saved data
		points = [
			[-2.0, 0.0, 0.499],
			[-2.0, 0.0, -0.499],
			[-0.499, 0.0, -0.499],
			[-0.499, 0.0, -2.0],
			[0.499, 0.0, -2.0],
			[0.499, 0.0, -0.499],
			[2.0, 0.0, -0.499],
			[2.0, 0.0, 0.499],
			[0.499, 0.0, 0.499],
			[0.499, 0.0, 2.0],
			[-0.499, 0.0, 2.0],
			[-0.499, 0.0, 0.499],
			[-2.0, 0.0, 0.499],  # close loop
		]
		
		# Create linear curve (degree 1 = straight lines)
		crv = cmds.curve(d=1, p=points, n=name)
		
		# Freeze transforms
		cmds.makeIdentity(crv, apply=True, t=1, r=1, s=1, n=0)
		
		return crv










